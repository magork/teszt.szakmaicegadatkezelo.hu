<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>	<head>		<title>EZ pagination For Smarty</title>	</head>	<body bgcolor="#ffffff">		<b>EZ pagination For Smarty <br>		</b><br>		One of the questions you will regularly see on PHP message boards is how to make &quot;paged&quot; results on a web site. You know what I'm talking about. &quot;page 1 of x&quot;  or &quot;click here for the next x results&quot;.  It's not particularly difficult, but it does take some thought, especially if you want a polished result. Well, it just got a lot easier as Justin Vincent has an excellent pagination class called ez_results (http://justinvincent.com/) that takes care of all the drudgery. <br>		<br>What has that got to do with Smarty I hear you ask. If you are about to ask what Smarty is (Smarty.php.net), then you should stop reading and go install / implement Smarty now. Easier website construction is just a step away.<br>		<br>		This article is not about Smarty itself but about the adaptation of ez_results for Smarty, becoming a new/modified class called Smart EZ Results.<br>		<br>		I modified ez_results because Justin has written his class to be a complete presentation of the result sets, including HTML tables, style sheets et al. As you may or may not know, Smarty is all about separating presentation from logic, HTML from PHP.<br>		<br>		So, first we&#146;ll take a look at the Smarty process and then onto pagination.<br>		<br>		Smarty is a class. In simplistic terms it's usage is: <br>		   - Instantiate a Smarty object<br>		   - Push the data for the page into the Smarty object<br>		   - Get Smarty to apply the template(s) to the data -- (&#147;skin&#148; the object so to speak)<br>		<br>		In code it looks like this:<br>		<br>		<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#f5f5dc">			<tr>				<td><code>include '/path/to/Smarty.php';<br>$Smarty=new Smarty;<br>$Smarty-&gt;assign('somevar', 'some data I want to display');<br>$Smarty-&gt;assign('some_db_results', $db-&gt;get_my_data());<br>$Smarty-&gt;display('name_of_template.tpl');<br>					</code></td>			</tr>		</table>		<br>		The template has entries for {$somevar} and {$some_db_results} so the assigned data is displayed inside the template at those points.<br>		<br>Moving on to result sets we follow the same outline as above. I have added comments to ensure clarity. The Smart EZ Results class is called ez_results.Smarty.php.<br>		<br>		<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#f5f5dc">			<tr>				<td><code>/* the included file instantiates the object $ezr */<br>include_once &quot;/path/to/ez_results.Smarty.php&quot;;<br>						<br>						/* <br>get_results() returns a multi dimensional array - each row of the array is a row from the database, the same as mysql_fetch_array. The number of rows returned is set during the configuration of Smart EZ Results. Push the results straight into a Smarty variable for layout in the final template.<br>						*/<br>$Smarty-&gt;assign('DB_OUTPUT', $ezr-&gt;get_results($q));<br>						<br>						/*<br>						get_navigation() returns an array,  each part of the results navigation is an array entry. The first_page, last_page, prev, next and nav variables are links if they are valid. A print_r of the returned array would look like this:<br>						Array <br>							(<br>								[num_records] =&gt; 56<br>								[num_pages] =&gt; 6<br>								[first_page] =&gt; &lt;&lt; <br>								[prev] =&gt; &lt; <br>								[nav] =&gt; 1 2 3 4 5 <br>								[next] =&gt; &gt;<br>								[last_page] =&gt; &gt;&gt;<br>						[current_page] =&gt; 1<br>							)<br>						<br>Assign the results to the Smarty variable 'RESULTS'<br>						*/<br>$Smarty-&gt;assign('RESULTS', $ezr-&gt;get_navigation());<br>						<br>						/*<br>						Next, get the pagination template. <br>Following the principal of &quot;once and only once&quot; I personally use a template to layout the navigation using tables, font colors and so on. A difference here is that the output of the template is pushed straight into a Smarty variable using the Smarty fetch() method. Wherever you want the navigation in your final page, you simply put {$PAGINATION} and that is where the finished, formatted results navigation will show up. You can of course figure out your own method of using this.<br>						*/<br>$Smarty-&gt;assign('PAGINATION', $Smarty-&gt;fetch('pagination.tpl'));<br>					</code></td>			</tr>		</table>		<br>		That&#146;s it for the php part of the equation, now let&#146;s look at an example template pagination.tpl.<br>		<br>		<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#f5f5dc">			<tr>				<td><code>&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;3&quot;&gt;<br>							&lt;tr&gt;<br>								&lt;td&gt;&lt;b&gt;Page:&lt;/b&gt; <br>						{$RESULTS.current_page} of {$RESULTS.num_pages}<br>						&lt;/td&gt;<br>								&lt;td&gt;({$RESULTS.num_records} items)&lt;/td&gt;<br>								&lt;td&gt;{$RESULTS.first_page}&lt;/td&gt;<br>								&lt;td&gt;{$RESULTS.prev}&lt;/td&gt;<br>&lt;td&gt;{$RESULTS.nav}&lt;/td&gt;<br>								&lt;td&gt;{$RESULTS.next}&lt;/td&gt;<br>								&lt;td&gt;{$RESULTS.last_page}&lt;/td&gt;<br>							&lt;/tr&gt;<br>						&lt;/table&gt;<br>					</code></td>			</tr>		</table>		<br>		And an example output: <br>		<br>		<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#f5f5dc">			<tr>				<td><b>Page:</b> 1 of 14 (83 items) <b>1</b> <a href="#">2</a> <a href="#">3</a> <a href="#">4</a> <a href="#">5</a> <a href="#">&gt;</a> <a href="#">&gt;&gt;</a><br>				</td>			</tr>		</table>		<br>		This is a very basic row layout with each item of the navigation in it&#146;s own table cell, however, this brings up the question of how to format each part of the result, such as the 1 2 3 4 5 paging. For example,how to make the page number the browser is on displayed as bold.<br>		<br>		That has been covered using stylesheets<br>		<br>		The format is: 'ezr_' + name of the returned variable, &#147;ezr_first_page&#148; for the first_page variable and so on. If the result will be both linked and not linked, then the unlinked stylesheet name has &#147;_na&#148; appended eg. ezr_first_page_na<br>		<br>		Note that the num_records &amp; num_pages are never links but to maintain a uniform interface they have a style available as well.<br>		<br>		here is an ultra simple stylesheet example:<br>		<br>		<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#f5f5dc">			<tr>				<td>.ezr_num_records { }<br>							 .ezr_num_pages { }<br>							 .ezr_first_page { font-weight: bold; text-decoration: underline }<br>							 .ezr_first_page_na { color: #a9a9a9 }<br>							 .ezr_back { font-weight: bold; text-decoration: underline }<br>							 .ezr_back_na { color: #a9a9a9 }<br>							 .ezr_nav { font-weight: bold; text-decoration: underline }<br>							 .ezr_nav_na { font-weight: bold; color: #000000 }<br>							 .ezr_next { font-weight: bold; text-decoration: underline }<br>							 .ezr_next_na { color: #a9a9a9 }<br>							 .ezr_last_page { font-weight: bold; text-decoration: underline }<br>							 .ezr_last_page_na { color: #a9a9a9 }<br>				</td>			</tr>		</table>		<br>				This stylesheet will make all the active links underlined, the non-active links gray and the current page number bold black.<br>		<br>The final layout template would use {$ DB_OUTPUT } in a Smarty foreach loop to layout the actual results and the pagination would be wherever the {$PAGINATION} tag is placed.<br>		<br>That&#146;s about it. It may seem, reading through this description that this is a complex undertaking but you could not be further from the truth. The php code required is usually no more than a few lines and the html layout, well, get the designer to do that, or do it yourself in any HTML layout program.<br>		<br>		Happy coding,<br>		<br>		Steve Warwick Ph.D.<br>				articles@clickbuild.com<br>		<hr>				For information on using Justin&#146;s class EzSQL  check out my article &#147;Making Smarty Ezier.&#148;	</body></html>